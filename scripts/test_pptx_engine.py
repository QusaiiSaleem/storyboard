#!/usr/bin/env python3
"""
Test: Regenerate NJR01_U02 Interactive Lecture using the new PPTX engine.
This validates the template engine produces correct output.
"""
import sys
sys.path.insert(0, "/Users/qusaiabushanap/dev/storyboard")

from engine.pptx_engine import LectureBuilder

# Create builder with project info
builder = LectureBuilder(
    project_code="NJR01",
    unit_number=2,
    unit_name="الذهنية الرقمية وممارسات الابتكار التقني",
    institution="جامعة نجران - كلية علوم الحاسب ونظم المعلومات"
)

# ─── Slide 1: Title ───
builder.add_title_slide(
    title="الذهنية الرقمية وممارسات الابتكار التقني",
    subtitle="الوحدة الثانية"
)

# ─── Slide 2: Objectives ───
builder.add_objectives_slide(objectives=[
    "ان يعدد المتعلم عناصر الابتكار الثلاثة وتقنيات العصف الذهني الاساسية",
    "ان يوضح المتعلم مفهوم ريادة الاعمال وعلاقتها بالابتكار التقني",
    "ان يشرح المتعلم المراحل الخمس للتفكير التصميمي ودور كل مرحلة",
    "ان يطبق المتعلم طريقة SCAMPER لتوليد افكار ابداعية جديدة",
    "ان يستخدم المتعلم مراحل التفكير التصميمي لبناء نموذج اولي",
    "ان يحلل المتعلم العلاقة بين التكنولوجيا وملاءمة السوق",
    "ان يقيم المتعلم فرص العمل الريادية بناء على معايير محددة",
    "ان يصمم المتعلم حلا ابتكاريا لمشكلة رقمية واقعية",
])

# ─── Slide 3: Agenda ───
builder.add_content_slide(
    title="محاور المحاضرة",
    bullets=[
        "المحور الاول: ما هو الابتكار واهمية توليد الافكار",
        "المحور الثاني: ريادة الاعمال وعقلية الابتكار التقني",
        "المحور الثالث: التفكير التصميمي ومراحله الخمس",
        "المحور الرابع: المرونة والتكيف وملاءمة السوق",
        "المحور الخامس: بناء عقلية ريادية والتغلب على التحديات",
    ],
    notes="Storyline: عرض المحاور بشكل متتابع مع تأثير ظهور تدريجي"
)

# ─── Slide 4: What is Innovation? ───
builder.add_content_with_cards(
    title="ما هو الابتكار؟",
    cards=[
        {"title": "حلول جديدة", "body": "ايجاد حلول مبتكرة وجديدة للمشاكل الواقعية التي تواجه الافراد والمؤسسات"},
        {"title": "تحسين الموجود", "body": "الابتكار يقوم بتحسين العمليات او المنتجات او الخدمات الحالية وتطويرها"},
        {"title": "تقنيات جديدة", "body": "يتضمن الابتكار استخدام تقنيات جديدة او اساليب ابداعية لم تكن مستخدمة من قبل"},
    ],
    notes="Storyline: عرض البطاقات الثلاث بشكل متتابع عند النقر"
)

# ─── Slide 5: Importance of Idea Generation ───
builder.add_content_slide(
    title="اهمية توليد الافكار",
    bullets=[
        "اساس الابتكار هو توليد افكار متنوعة تتطلب التفكير خارج الصندوق",
        "تقنيات العصف الذهني:",
        "  - التواصل الحر: دع الافكار تتدفق دون اصدار احكام",
        "  - الخرائط الذهنية: ربط الافكار والمفاهيم بصريا",
        "  - طريقة SCAMPER: اداة فعالة لتوليد افكار جديدة بشكل منهجي",
    ],
    notes="Storyline: عرض التقنيات بشكل متتابع"
)

# ─── Slide 6: SCAMPER Method ───
builder.add_click_reveal_slide(
    title="طريقة SCAMPER لتوليد الافكار",
    instruction="انقر على كل حرف لعرض التفاصيل",
    reveal_items=[
        {"label": "S - استبدال (Substitute)", "detail": "ما الذي يمكن استبداله في المنتج او الخدمة؟"},
        {"label": "C - دمج (Combine)", "detail": "ما الذي يمكن دمجه مع عنصر آخر؟"},
        {"label": "A - تكيف (Adapt)", "detail": "ما الذي يمكن تكييفه من مجال آخر؟"},
        {"label": "M - تعديل (Modify)", "detail": "ما الذي يمكن تعديله او تكبيره او تصغيره؟"},
        {"label": "P - استخدام آخر (Put to use)", "detail": "هل يمكن استخدامه في مكان آخر؟"},
        {"label": "E - حذف (Eliminate)", "detail": "ما الذي يمكن حذفه او تبسيطه؟"},
        {"label": "R - عكس (Reverse)", "detail": "ماذا لو عكسنا الترتيب او الاتجاه؟"},
    ],
    notes="Storyline: تفاعل Click-to-Reveal\n- اخفاء التفاصيل في البداية\n- عند النقر على كل عنصر يظهر الوصف"
)

# ─── Slide 7: Quiz 1 ───
builder.add_quiz_slide(
    question="ما هو الحرف الذي يمثل 'الحذف' في طريقة SCAMPER؟",
    options=["S - Substitute", "E - Eliminate", "M - Modify", "R - Reverse"],
    correct_index=1,
    quiz_number=1,
    total_quizzes=5
)

# ─── Slide 8: Entrepreneurship ───
builder.add_content_with_cards(
    title="ما هي ريادة الاعمال؟",
    cards=[
        {"title": "حل المشكلات", "body": "القدرة على تحديد المشكلات وتحليلها وايجاد حلول عملية فعالة"},
        {"title": "الابداع", "body": "التفكير بطرق غير تقليدية لايجاد حلول مبتكرة وفريدة من نوعها"},
        {"title": "المرونة", "body": "القدرة على التكيف مع التغيرات والظروف المختلفة بسرعة"},
    ],
    notes="ريادة الاعمال هي تحويل الافكار الى مشاريع ناجحة"
)

# ─── Slide 9: Tech Innovation Mindset ───
builder.add_content_with_cards(
    title="عقلية الابتكار التقني",
    cards=[
        {"title": "التفكير التصميمي", "body": "فهم احتياجات المستخدم قبل تطوير الحلول الرقمية"},
        {"title": "المرونة والتكيف", "body": "الاستجابة للتغيرات التكنولوجية المتسارعة"},
        {"title": "ملاءمة السوق", "body": "ضمان تلبية المنتجات الرقمية لاحتياجات السوق الفعلية"},
    ],
    notes="عقلية الابتكار التقني هي القدرة على تطوير حلول ابداعية باستخدام التكنولوجيا"
)

# ─── Slide 10: Quiz 2 ───
builder.add_quiz_slide(
    question="اي من التالية ليست من المتطلبات الرئيسية لعقلية الابتكار التقني؟",
    options=["التفكير التصميمي", "المرونة والقدرة على التكيف", "البرمجة بلغة Python", "ملاءمة التكنولوجيا للسوق"],
    correct_index=2,
    quiz_number=2,
    total_quizzes=5
)

# ─── Slide 11: Section Divider ───
builder.add_section_divider(
    section_title="التفكير التصميمي",
    section_subtitle="نهج ابتكاري متمحور حول الانسان يستخدمه شركات مثل جوجل وآبل"
)

# ─── Slide 12: Design Thinking Overview ───
builder.add_content_slide(
    title="ما هو التفكير التصميمي؟",
    bullets=[
        "نهج ابتكاري متمحور حول الانسان لحل المشكلات",
        "يركز على فهم احتياجات المستخدم قبل تطوير الحلول",
        "يستخدم النهج التكراري: بناء الافكار واختبارها وتحسينها",
        "يستخدم من قبل شركات عالمية رائدة مثل جوجل وآبل",
    ]
)

# ─── Slide 13: 5 Stages ───
builder.add_click_reveal_slide(
    title="المراحل الخمس للتفكير التصميمي",
    instruction="انقر على كل مرحلة لعرض التفاصيل",
    reveal_items=[
        {"label": "1. التعاطف", "detail": "فهم احتياجات المستخدم من خلال الملاحظة والمقابلات واختبارات المستخدمين"},
        {"label": "2. التحديد", "detail": "توضيح وتعريف المشكلة بدقة بعد فهم احتياجات المستخدم"},
        {"label": "3. التفكير", "detail": "تبادل الافكار وتوليد حلول متعددة - الهدف هو الكم وليس الكيف"},
        {"label": "4. النموذج الاولي", "detail": "بناء نماذج بسيطة واختبارها - لا تحتاج لان تكون مثالية"},
        {"label": "5. الاختبار", "detail": "تقييم الحل وتحسينه من خلال التجربة والتكرار المستمر"},
    ],
    notes="Storyline: عرض متتابع Sequential Reveal - المراحل تظهر واحدة تلو الاخرى"
)

# ─── Slide 14: Empathy & Needs ───
builder.add_content_with_cards(
    title="التعاطف وتحديد الاحتياجات",
    cards=[
        {"title": "الملاحظة", "body": "ملاحظة كيفية استخدام الناس للمنتجات في الحياة الواقعية"},
        {"title": "المقابلات", "body": "المشاركة في مقابلات مع المستخدمين للتعرف على وجهات نظرهم"},
        {"title": "استطلاعات الرأي", "body": "اجراء استطلاعات رأي لجمع آراء المستخدمين بشكل واسع"},
    ],
    notes="تحديد احتياجات المستخدم الحقيقية هو اساس الابتكار الهادف"
)

# ─── Slide 15: Define, Ideate, Prototype ───
builder.add_content_slide(
    title="التحديد والتفكير والنمذجة",
    bullets=[
        "التحديد: توضيح وتعريف المشكلة بدقة بعد فهم احتياجات المستخدم",
        "التفكير: تبادل الافكار وتوليد حلول متعددة - كلما زادت الافكار كان افضل",
        "النموذج الاولي: بناء نماذج بسيطة واختبارها بسرعة وبأقل تكلفة",
        "العملية تكرارية: يمكن العودة لاي مرحلة سابقة حسب الحاجة",
    ]
)

# ─── Slide 16: Testing & Iteration ───
builder.add_content_with_cards(
    title="الاختبار والتكرار",
    cards=[
        {"title": "بناء", "body": "بناء النموذج الاولي بسرعة"},
        {"title": "اختبار", "body": "اختبار النموذج مع المستخدمين الحقيقيين"},
        {"title": "صقل", "body": "تحسين النموذج بناء على الملاحظات"},
        {"title": "تكرار", "body": "تكرار العملية حتى الوصول للحل الامثل"},
    ],
    notes="التفكير التصميمي عملية تكرارية وليست خطية"
)

# ─── Slide 17: Quiz 3 ───
builder.add_drag_drop_slide(
    question="رتب المراحل الخمس للتفكير التصميمي بالترتيب الصحيح:",
    items=["النموذج الاولي", "التعاطف", "الاختبار", "التحديد", "التفكير"],
    correct_order=["التعاطف", "التحديد", "التفكير", "النموذج الاولي", "الاختبار"],
    quiz_number=3
)

# ─── Slide 18: Flexibility vs Adaptability ───
builder.add_two_column_slide(
    title="المرونة مقابل القدرة على التكيف",
    left_title="المرونة",
    left_points=[
        "القدرة على الاستجابة للتحديات او الفرص الفورية بكفاءة",
        "تتعامل مع التغيرات قصيرة المدى",
        "تتطلب سرعة في اتخاذ القرارات",
        "مثال: تكيف المطاعم مع التوصيل اثناء كورونا",
    ],
    right_title="القدرة على التكيف",
    right_points=[
        "القدرة على التطور والازدهار استجابة للتحولات الجذرية",
        "تتعامل مع التغيرات طويلة الامد في البيئة",
        "تتطلب اعادة تشكيل الاستراتيجيات",
        "مثال: تحول نوكيا من الورق الى الاتصالات",
    ]
)

# ─── Slide 19: Business Opportunities ───
builder.add_content_with_cards(
    title="تحديد فرص العمل",
    cards=[
        {"title": "احتياجات العملاء", "body": "فهم ما يحتاجه العملاء فعلا وليس ما نظن انهم يحتاجونه"},
        {"title": "دراسة الجدوى", "body": "التأكد من ان المشروع قابل للتنفيذ تقنيا وماليا وعمليا"},
        {"title": "قابلية التوسع", "body": "امكانية نمو المشروع وتوسعه للوصول الى شريحة اكبر"},
    ],
    notes="الفكرة يجب ان تحظى بطلب في السوق لتكون مشروعا قابلا للاستمرار"
)

# ─── Slide 20: Market Fit ───
builder.add_content_slide(
    title="التكنولوجيا وملاءمة السوق",
    bullets=[
        "ملاءمة السوق = ضمان تلبية المنتجات الرقمية لاحتياجات السوق الفعلية",
        "التكنولوجيا يجب ان تتوافق مع احتياجات المستخدم لتحقيق النجاح",
        "ملاءمة السوق ضرورية للتبني وقابلية التوسع",
        "النهج التكراري يضمن مواءمة التكنولوجيا للسوق",
        "الشركات الناجحة تعالج مشاكل العملاء الفعلية",
    ]
)

# ─── Slide 21: Prototyping & A/B Testing ───
builder.add_content_with_cards(
    title="النمذجة والتجريب واختبار A/B",
    cards=[
        {"title": "نماذج ورقية", "body": "رسومات تخطيطية سريعة على الورق لاختبار الافكار"},
        {"title": "نماذج رقمية", "body": "نماذج برمجية تفاعلية باستخدام ادوات التصميم"},
        {"title": "نماذج مادية", "body": "نماذج منتجات اولية ملموسة للاختبار"},
        {"title": "اختبار A/B", "body": "مقارنة بين نسختين مختلفتين لمعرفة الانسب"},
    ],
    notes="اختبار A/B يقارن بين فكرتين لمعرفة الانسب - التكرار المستمر يؤدي لمنتجات افضل"
)

# ─── Slide 22: Quiz 4 ───
builder.add_quiz_slide(
    question="ما هو الهدف الرئيسي من اختبار A/B؟",
    options=["اختبار البرمجة فقط", "المقارنة بين فكرتين لمعرفة الانسب", "حذف المنتجات القديمة", "تصميم الشعارات"],
    correct_index=1,
    quiz_number=4,
    total_quizzes=5
)

# ─── Slide 23: Section Divider ───
builder.add_section_divider(
    section_title="بناء عقلية ريادية",
    section_subtitle="المحور الخامس: كيف تبني عقلية ريادة الاعمال؟"
)

# ─── Slide 24: Entrepreneurial Mindset ───
builder.add_content_slide(
    title="كيفية بناء عقلية ريادية؟",
    bullets=[
        "رؤية الفشل كفرصة للتعلم - كل محاولة فاشلة تقربك من النجاح",
        "الانفتاح على التغذية الراجعة والتكيف مع النقد البناء",
        "البقاء فضوليا والتحسين المستمر - لا تتوقف عن التعلم",
    ]
)

# ─── Slide 25: Tools & Resources ───
builder.add_content_with_cards(
    title="ادوات ومصادر لرائد الاعمال",
    cards=[
        {"title": "Lean Startup", "body": "منهجية الشركات الناشئة المرنة للتطوير السريع وبناء MVP"},
        {"title": "Business Model Canvas", "body": "نموذج العمل التجاري لهيكلة الافكار التجارية في صفحة واحدة"},
        {"title": "التعلم المستمر", "body": "منصات مثل Stanford Online و Coursera للتعلم المتخصص"},
    ]
)

# ─── Slide 26: Overcoming Challenges ───
builder.add_two_column_slide(
    title="التغلب على تحديات الابتكار",
    left_title="التحديات",
    left_points=[
        "مقاومة التغيير امر شائع",
        "الخوف من الفشل يمكن ان يعيق الابداع",
    ],
    right_title="الحلول",
    right_points=[
        "تشجيع التجربة: خلق بيئة آمنة لتجربة اشياء جديدة",
        "تعزيز ثقافة الانفتاح: تشجيع التواصل المفتوح للتعلم",
        "الاحتفاء بالتعلم من الفشل",
    ]
)

# ─── Slide 27: Quiz 5 ───
builder.add_quiz_slide(
    question="اي من التالية يعتبر من سمات العقلية الريادية؟",
    options=[
        "الخوف من المخاطرة وتجنب التجارب الجديدة",
        "رؤية الفشل كفرصة للتعلم والتحسين المستمر",
        "رفض التغذية الراجعة من الآخرين",
        "التمسك بالخطة الاصلية دون اي تعديل",
    ],
    correct_index=1,
    quiz_number=5,
    total_quizzes=5
)

# ─── Slide 28: Summary ───
builder.add_summary_slide(summary_items=[
    {"title": "الابتكار", "body": "ايجاد حلول جديدة باستخدام تقنيات ابداعية مثل SCAMPER"},
    {"title": "ريادة الاعمال", "body": "تحويل الافكار لمشاريع ناجحة تتطلب حل المشكلات والمرونة"},
    {"title": "التفكير التصميمي", "body": "5 مراحل: التعاطف، التحديد، التفكير، النمذجة، الاختبار"},
    {"title": "ملاءمة السوق", "body": "التكنولوجيا + احتياجات السوق + النمذجة + اختبار A/B"},
    {"title": "العقلية الريادية", "body": "الفشل فرصة، التغذية الراجعة ضرورية، التعلم مستمر"},
])

# ─── Slide 29: Closing ───
builder.add_closing_slide(next_steps=[
    "اكمال الانشطة التفاعلية المرتبطة بالوحدة",
    "المشاركة في نشاط النقاش حول العقلية الرقمية",
    "تطبيق التفكير التصميمي في حل مشكلة رقمية (الواجب)",
    "الاستعداد للاختبار البعدي",
])

# Finalize cross-slide links (btn_start -> slide 2, etc.)
builder.finalize()

# Save
output_path = "/Users/qusaiabushanap/dev/storyboard/output/NJR01/U02/NJR01_U02_Interactive_Lecture_v3.pptx"
builder.save(output_path)
print(f"SUCCESS! Generated {len(builder.prs.slides)} slides")
print(f"Saved to: {output_path}")
